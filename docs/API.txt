# API Documentation - Panel TGDM

## ğŸ“– DescripciÃ³n General

API RESTful para el sistema de gestiÃ³n de torneos y mesas de juego Panel TGDM.

**Base URL:** `http://localhost:8080/api`

## ğŸ” AutenticaciÃ³n

El sistema utiliza autenticaciÃ³n basada en cookies. Todas las rutas (excepto login) requieren autenticaciÃ³n.

### Login
```http
GET /api/users/userlogin?name={username}&password={hashedPassword}
```

**ParÃ¡metros:**
- `name`: Nombre de usuario (string)
- `password`: ContraseÃ±a hasheada con MD5 (string)

**Respuesta exitosa:**
```json
[
  {
    "_id": "user_id",
    "name": "username",
    "email": "user@example.com",
    "rol": "admin|representante|agente",
    "grupo": ["grupo_id"]
  }
]
```

## ğŸ‘¥ Usuarios

### Listar usuarios
```http
GET /api/users
```

### Obtener usuario por ID
```http
GET /api/users/:id
```

### Crear usuario
```http
POST /api/users
```

**Body:**
```json
{
  "name": "string",
  "password": "string",
  "email": "string",
  "telefono": "number",
  "rol": "admin|representante|agente",
  "grupo": ["grupo_id"]
}
```

### Actualizar usuario
```http
PUT /api/users/:id
```

### Eliminar usuario
```http
DELETE /api/users/:id
```

## ğŸ¢ Grupos

### Listar grupos
```http
GET /api/grupos
```

### Obtener grupo por ID
```http
GET /api/grupos/:id
```

### Crear grupo
```http
POST /api/grupos
```

**Body:**
```json
{
  "nombre": "string",
  "representante": ["user_id"],
  "admins": ["user_id"]
}
```

### Actualizar grupo
```http
PUT /api/grupos/:id
```

### Eliminar grupo
```http
DELETE /api/grupos/:id
```

## ğŸ® Jugadores

### Listar jugadores
```http
GET /api/jugadores
```

### Obtener jugador por ID
```http
GET /api/jugadores/:id
```

### Crear jugador
```http
POST /api/jugadores
```

**Body:**
```json
{
  "id": "number",
  "nombre": "string",
  "usuario": "string",
  "password": "string",
  "telefono": "number",
  "grupo": ["grupo_id"]
}
```

### Actualizar jugador
```http
PUT /api/jugadores/:id
```

### Agregar carga al jugador
```http
POST /api/jugadores/:id/carga
```

**Body:**
```json
{
  "monto": "number",
  "descripcion": "string"
}
```

### Agregar retiro al jugador
```http
POST /api/jugadores/:id/retiro
```

**Body:**
```json
{
  "monto": "number",
  "descripcion": "string"
}
```

## ğŸ† Eventos

### Listar eventos
```http
GET /api/eventos
```

### Obtener evento por ID
```http
GET /api/eventos/:id
```

### Crear evento
```http
POST /api/eventos
```

**Body:**
```json
{
  "nombre": "string",
  "categoria": "mam|tor|camp",
  "color": "string",
  "jugadores": "number",
  "entrada": "number",
  "premio": "number",
  "puntos": "number",
  "comicion": "number",
  "descripcion": "string",
  "grupo": ["grupo_id"]
}
```

### Actualizar evento
```http
PUT /api/eventos/:id
```

### Eliminar evento
```http
DELETE /api/eventos/:id
```

## ğŸ¯ Mesas

### Listar mesas
```http
GET /api/mesas
```

### Obtener mesa por ID
```http
GET /api/mesas/:id
```

### Crear mesa
```http
POST /api/mesas
```

**Body:**
```json
{
  "grupo": "grupo_id",
  "evento": "evento_id",
  "jugadores": ["jugador_id"],
  "creador": "user_id"
}
```

### Finalizar mesa
```http
PUT /api/mesas/:id/finalizar
```

**Body:**
```json
{
  "ganador": "jugador_id"
}
```

### Listar mesas activas
```http
GET /api/mesas/activas
```

### Listar mesas finalizadas
```http
GET /api/mesas/finalizadas
```

### Filtrar mesas
```http
GET /api/mesas/filtrar?grupo={grupo_id}&evento={evento_id}&fecha={fecha}
```

## ğŸ“Š EstadÃ­sticas y Balance

### Balance general
```http
GET /api/balance
```

### EstadÃ­sticas por grupo
```http
GET /api/estadisticas/grupo/:id
```

### EstadÃ­sticas por jugador
```http
GET /api/estadisticas/jugador/:id
```

## ğŸš¨ CÃ³digos de Estado HTTP

- `200` - OK
- `201` - Creado
- `400` - Solicitud incorrecta
- `401` - No autorizado
- `403` - Prohibido
- `404` - No encontrado
- `500` - Error interno del servidor

## ğŸ”§ ConfiguraciÃ³n de CORS

El servidor estÃ¡ configurado para aceptar solicitudes desde:
- `http://localhost:5173` (desarrollo)
- Configurar URLs de producciÃ³n segÃºn necesidad

## ğŸ“ Notas Importantes

1. **AutenticaciÃ³n**: Todas las rutas requieren autenticaciÃ³n excepto `/api/users/userlogin`
2. **ValidaciÃ³n**: Los datos de entrada son validados en el servidor
3. **Referencias**: Los modelos utilizan ObjectId de MongoDB para referencias
4. **Fechas**: Las fechas se almacenan como strings con formato ISO
5. **Seguridad**: ContraseÃ±as hasheadas con MD5 (recomendado migrar a bcrypt)

## ğŸ› ï¸ Herramientas de Desarrollo

### Postman Collection
Disponible en: `docs/postman/Panel-TGDM.postman_collection.json`

### Swagger/OpenAPI
DocumentaciÃ³n interactiva disponible en: `http://localhost:8080/api-docs` (prÃ³ximamente)

## ğŸ”„ Versionado

VersiÃ³n actual: `v1.0.0`

Para futuras versiones, se utilizarÃ¡ versionado semÃ¡ntico y se mantendrÃ¡ compatibilidad hacia atrÃ¡s cuando sea posible.
